<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ржкрзНрж░рзЛржбрж╛ржХрзНржЯ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд | рж╢рж╛ржбрж╝рж┐ рж╕ржорзНржнрж╛рж░</title>
    
    <!-- рж╕рзНржЯрж╛ржЗрж▓рж╢рж┐ржЯ -->
    <link rel="stylesheet" href="styles/variables.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="modules/common/navbar/navbar.css">
    <link rel="stylesheet" href="modules/common/footer/footer.css">
    <link rel="stylesheet" href="modules/client/product-view/view.css">
</head>
<body>

    <!-- рзз. ржирзЗржнрж┐ржЧрзЗрж╢ржи ржмрж╛рж░ -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo" id="dynamic-nav-logo">рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...</a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">рж╣рзЛржо</a></li>
                <li><a href="shop.html" class="nav-link">ржХрж╛рж▓рзЗржХрж╢ржи</a></li>
            </ul>
        </div>
    </nav>

    <!-- рзи. ржорзЗржЗржи ржХржирзНржЯрзЗржирзНржЯ -->
    <div class="product-view-container">
        
        <!-- ржмрзНрж░рзЗржбржХрзНрж░рж╛ржорзНржм / ржмрзНржпрж╛ржХ ржмрж╛ржЯржи -->
        <div class="breadcrumb">
            <a href="shop.html" class="btn-back">тмЕ ржХрж╛рж▓рзЗржХрж╢ржирзЗ ржлрж┐рж░рзЗ ржпрж╛ржи</a>
        </div>

        <div class="product-details-grid">
            <!-- ржмрж╛ржо ржкрж╛рж╢: ржЫржмрж┐ -->
            <div class="image-section">
                <div class="main-image-box">
                    <img id="view-img" src="" alt="Product Image">
                </div>
            </div>

            <!-- ржбрж╛ржи ржкрж╛рж╢: рждржерзНржп -->
            <div class="info-section">
                <p class="product-category" id="view-category">ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐</p>
                <h1 id="view-name" class="product-title">рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...</h1>
                
                <div class="price-tag">
                    <span class="currency">тВ╣</span> <span id="view-price">0</span>
                </div>

                <!-- ЁЯСЗ ржирждрзБржи: ржкрзНрж░рзЛржбрж╛ржХрзНржЯ рж╕рзНржкрзЗрж╕рж┐ржлрж┐ржХрзЗрж╢ржи ржЯрзЗржмрж┐рж▓ -->
                <div class="specs-box" style="background:#f9f9f9; padding:15px; border-radius:8px; margin-bottom:20px;">
                    <p><strong>ЁЯОи рж░ржЩ:</strong> <span id="view-color">...</span></p>
                    <p><strong>ЁЯз╡ ржХрж╛ржкржбрж╝:</strong> <span id="view-material">...</span></p>
                    <p><strong>ЁЯУП рж╕рж╛ржЗржЬ:</strong> <span id="view-size">...</span></p>
                </div>

                <div class="divider"></div>

                <div class="description-box">
                    <h3>ржкржгрзНржпрзЗрж░ ржмрж┐ржмрж░ржг:</h3>
                    <p id="view-desc">...</p>
                </div>

                <!-- ржЕрзНржпрж╛ржХрж╢ржи ржмрж╛ржЯржи -->
                <div class="action-buttons">
                    <button class="btn btn-primary btn-lg" onclick="orderNow()">
                        ЁЯЫТ ржЕрж░рзНржбрж╛рж░ ржХрж░рзБржи
                    </button>
                    <button class="btn btn-whatsapp btn-lg" onclick="orderOnWhatsApp()">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" width="24"> 
                        WhatsApp Order
                    </button>
                </div>

                <!-- ржЕрждрж┐рж░рж┐ржХрзНржд рждржерзНржп -->
                <div class="features-list">
                    <div class="feat-item">ЁЯЪЪ рж╕рж╛рж░рж╛ ржнрж╛рж░рждрзЗ ржлрзНрж░рж┐ ржбрзЗрж▓рж┐ржнрж╛рж░рж┐</div>
                    <div class="feat-item">ЁЯТО рззрзжрзж% ржЕрж░рж┐ржЬрж┐ржирж╛рж▓ ржкрзНрж░рзЛржбрж╛ржХрзНржЯ</div>
                    <div class="feat-item">ЁЯФД рзн ржжрж┐ржирзЗрж░ рж╕рж╣ржЬ рж░рж┐ржЯрж╛рж░рзНржи</div>
                </div>
            </div>
        </div>
    </div>

    <!-- рзй. ржлрзБржЯрж╛рж░ -->
    <footer class="site-footer">
        <p>&copy; рзирзжрзирзл рж╢рж╛ржбрж╝рж┐ рж╕ржорзНржнрж╛рж░</p>
    </footer>

    <!-- рзк. ржЕрж░рзНржбрж╛рж░ ржорзЛржбрж╛рж▓ -->
    <div id="order-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div class="modal-header">
                <h2>ржЕрж░рзНржбрж╛рж░ ржХржиржлрж╛рж░рзНржо ржХрж░рзБржи</h2>
                <p>ржЖржкржирж╛рж░ рждржерзНржп ржжрж┐ржи, ржЖржорж░рж╛ ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░ржм</p>
            </div>
            <form id="order-form">
                <div class="form-group">
                    <label>ржЖржкржирж╛рж░ ржирж╛ржо</label>
                    <input type="text" id="cust-name" placeholder="ржирж╛ржо рж▓рж┐ржЦрзБржи" required>
                </div>
                <div class="form-group">
                    <label>ржорзЛржмрж╛ржЗрж▓ ржиржорзНржмрж░</label>
                    <input type="text" id="cust-phone" placeholder="ржлрзЛржи ржиржорзНржмрж░" required>
                </div>
                <div class="form-group">
                    <label>ржкрзВрж░рзНржг ржарж┐ржХрж╛ржирж╛</label>
                    <textarea id="cust-address" rows="3" placeholder="ржмрж╛рж╕рж╛рж░ ржарж┐ржХрж╛ржирж╛..." required></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-block">ржЕрж░рзНржбрж╛рж░ ржХржиржлрж╛рж░рзНржо ржХрж░рзБржи</button>
            </form>
        </div>
    </div>

    <!-- рж╕рзНржХрзНрж░рж┐ржкрзНржЯ -->
    <script type="module">
        import { db } from './config/firebase-config.js';
        import { doc, getDoc, addDoc, collection } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('id');
        let currentProduct = {};

        async function loadProduct() {
            if (!productId) return;
            const docRef = doc(db, "products", productId);
            const docSnap = await getDoc(docRef);
            if (docSnap.exists()) {
                const p = docSnap.data();
                currentProduct = { id: docSnap.id, ...p };
                
                document.getElementById('view-img').src = p.image;
                document.getElementById('view-name').innerText = p.name;
                document.getElementById('view-price').innerText = p.price;
                document.getElementById('view-category').innerText = p.category;
                document.getElementById('view-desc').innerText = p.description || "ржЦрзБржмржЗ ржЙржирзНржиржд ржорж╛ржирзЗрж░ ржХрж╛ржкржбрж╝ ржПржмржВ ржЖржзрзБржирж┐ржХ ржбрж┐ржЬрж╛ржЗржиред";

                // ЁЯСЗ ржирждрзБржи ржбрзЗржЯрж╛ ржмрж╕рж╛ржирзЛ
                document.getElementById('view-color').innerText = p.color || "N/A";
                document.getElementById('view-material').innerText = p.material || "N/A";
                document.getElementById('view-size').innerText = p.size || "Free Size";
            }
        }
        loadProduct();

        window.orderNow = () => document.getElementById('order-modal').style.display = 'flex';
        window.closeModal = () => document.getElementById('order-modal').style.display = 'none';
        
        window.orderOnWhatsApp = () => {
            const phone = "919876543210"; 
            const msg = `Hi, I want to order: ${currentProduct.name}, Price: тВ╣${currentProduct.price}`;
            window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`, '_blank');
        };

        document.getElementById('order-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            btn.innerText = "ржЕрж░рзНржбрж╛рж░ рж╣ржЪрзНржЫрзЗ...";
            try {
                await addDoc(collection(db, "orders"), {
                    customerName: document.getElementById('cust-name').value,
                    phone: document.getElementById('cust-phone').value,
                    address: document.getElementById('cust-address').value,
                    productName: currentProduct.name,
                    price: currentProduct.price,
                    status: 'pending',
                    orderDate: new Date()
                });
                alert("тЬЕ ржЕрж░рзНржбрж╛рж░ рж╕ржлрж▓ рж╣ржпрж╝рзЗржЫрзЗ! ржЖржорж░рж╛ рж╢рзАржШрзНрж░ржЗ ржХрж▓ ржХрж░ржмред");
                closeModal();
                e.target.reset();
            } catch (err) { alert("рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ"); }
            btn.innerText = "ржЕрж░рзНржбрж╛рж░ ржХржиржлрж╛рж░рзНржо ржХрж░рзБржи";
        });
    </script>

    <!-- ржЧрзНрж▓рзЛржмрж╛рж▓ ржмрзНрж░рзНржпрж╛ржирзНржбрж┐ржВ рж▓рзЛржбрж╛рж░ -->
    <script type="module" src="./utils/global-loader.js"></script>
</body>
</html>